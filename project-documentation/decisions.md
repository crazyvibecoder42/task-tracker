# Decisions

- 2026-02-10: For this review, we assume the backend runs in Docker. Under that assumption, using `UPLOAD_DIR = /app/uploads` is acceptable. The concern about `/app` not existing only applies to non-Docker local runs, so the upload path decision is considered low severity for this environment.
- 2026-02-10: SVG uploads are not allowed. Rationale: prevent XSS risk from inline/active content in SVGs. Frontend should not advertise `.svg` in file input accept lists.
- 2026-02-10: Content-Length required for security.
- 2026-02-11: [review-reconciler] Accepted pushback on API key auth O(n) hash verification cost. Guidance: do not flag this as an active defect at current scale; treat as a follow-up only when key volume or latency data indicates pressure. Scope: `backend/auth/dependencies.py` API key authentication path.
- 2026-02-11: Migration scripts are temporarily out of scope for active code reviews. Guidance: do not raise findings against files under `backend/migrations/` until this decision is revisited.
- 2026-02-11: [review-reconciler] Accepted pushback on per-request `last_login_at` / `last_used_at` timestamp commits. Guidance: do not flag auth-path timestamp writes as an active defect at current scale; revisit only with observed DB contention/latency signals. Scope: `backend/auth/dependencies.py` authentication dependency commit path.
- 2026-02-11: [review-reconciler] Accepted pushback on cookie-presence-only Next.js middleware gating. Guidance: do not flag middleware checks based on refresh-cookie presence (without token validity verification) as an active defect for this app architecture; client-side `AuthContext` handles token validation and redirect on auth failure. Scope: `frontend/middleware.ts` with `frontend/contexts/AuthContext.tsx` coordination.
- 2026-02-11: [review-reconciler] Accepted pushback on Uvicorn request-size flag removal. Guidance: do not flag removal of `--limit-max-request-size` as a regression; enforce upload size via application-level validation (`Content-Length` precheck + streaming byte count). Scope: `docker-compose.yml` backend command and `backend/main.py` upload handlers.
